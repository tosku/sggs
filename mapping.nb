(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27814,        698]
NotebookOptionsPosition[     26688,        655]
NotebookOutlinePosition[     27042,        671]
CellTagsIndexPosition[     26999,        668]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";", 
  RowBox[{"Clear", "[", "Derivative", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<lattice.wl\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.678288586928876*^9, 3.678288652689226*^9}, {
   3.678292473759671*^9, 3.678292578091207*^9}, {3.678350870848344*^9, 
   3.678350873880072*^9}, 3.678350912079718*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678371156298984*^9, 3.678371163298102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lattice", "=", 
   RowBox[{"getLattice", "[", 
    RowBox[{"L", ",", "d"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6783488702420597`*^9, 3.678348879544608*^9}, {
   3.678349118892337*^9, 3.678349126539381*^9}, 3.6783498892441196`*^9, 
   3.6783503661619253`*^9, 3.678350885607624*^9, 3.678351035676862*^9, 
   3.678352665347506*^9, {3.678353138761796*^9, 3.6783531569207973`*^9}, 
   3.6783532613210087`*^9, 3.678353295382255*^9, {3.678353327125453*^9, 
   3.6783533393493032`*^9}, {3.678353770204639*^9, 3.678353770572095*^9}, {
   3.6783602618691797`*^9, 3.678360269879266*^9}, {3.6783603522374268`*^9, 
   3.678360378020096*^9}, {3.678360511322579*^9, 3.678360511425651*^9}, 
   3.678362485048777*^9, 3.678362517648138*^9, {3.678371183681831*^9, 
   3.678371184649582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lattice", "=", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SetProperty", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       "lattice", ",", 
       RowBox[{"VertexList", "[", "lattice", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"lattice", "=", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SetProperty", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", 
         RowBox[{"EdgeLabels", "\[Rule]", 
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], ",", "EdgeCapacity"}], 
           "]"}]}]}], "]"}], "&"}], ",", "lattice", ",", 
      RowBox[{"EdgeList", "[", "lattice", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.678348908971418*^9, 3.678348931371005*^9}, {
   3.678349148637714*^9, 3.678349206634297*^9}, 3.678349243986505*^9, {
   3.678350376763186*^9, 3.6783503889943323`*^9}, {3.678353022036406*^9, 
   3.6783530234119997`*^9}, {3.6783610033996487`*^9, 3.678361014134769*^9}, {
   3.678361427153462*^9, 3.678361430309897*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{3, 7, 5, 9, 10, 14, 4, 13, 6, 11, 1, 15, 12, 16, 8, 2}, {
      Null, {{1, 2}, {3, 4}, {5, 6}, {4, 5}, {1, 7}, {8, 6}, {9, 5}, {2, 
       10}, {11, 3}, {6, 12}, {13, 14}, {15, 13}, {9, 2}, {10, 12}, {4, 8}, {
       7, 15}, {10, 13}, {5, 10}, {16, 9}, {3, 9}, {2, 15}, {12, 14}, {11, 
       16}, {16, 1}}}, {
      EdgeLabels -> {
        UndirectedEdge[6, 10] -> 1, UndirectedEdge[14, 15] -> 1, 
         UndirectedEdge[9, 10] -> 1, UndirectedEdge[3, 7] -> 1, 
         UndirectedEdge[5, 6] -> -1, UndirectedEdge[13, 14] -> 1, 
         UndirectedEdge[3, 4] -> 1, UndirectedEdge[1, 5] -> 1, 
         UndirectedEdge[5, 9] -> 1, UndirectedEdge[12, 16] -> 1, 
         UndirectedEdge[1, 2] -> -1, UndirectedEdge[4, 8] -> -1, 
         UndirectedEdge[7, 8] -> -1, UndirectedEdge[2, 3] -> -1, 
         UndirectedEdge[9, 13] -> -1, UndirectedEdge[8, 12] -> 1, 
         UndirectedEdge[15, 16] -> -1, UndirectedEdge[7, 11] -> 1, 
         UndirectedEdge[10, 11] -> -1, UndirectedEdge[2, 6] -> -1, 
         UndirectedEdge[11, 15] -> -1, UndirectedEdge[10, 14] -> 1, 
         UndirectedEdge[11, 12] -> -1, UndirectedEdge[6, 7] -> -1}, 
       VertexLabels -> {
        8 -> 8, 12 -> 12, 14 -> 14, 2 -> 2, 13 -> 13, 5 -> 5, 9 -> 9, 7 -> 7, 
         16 -> 16, 11 -> 11, 6 -> 6, 15 -> 15, 1 -> 1, 3 -> 3, 4 -> 4, 10 -> 
         10}, EdgeCapacity -> {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
         {Arrowheads[0.], 
          ArrowBox[{{3.0406895522888964`, 0.9793215736878705}, {
           2.0706726951048497`, 0.9710076615678785}}, 0.03059636970355739]}, 
         InsetBox["1", {2.555681123696873, 0.9751646176278745}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{3.0406895522888964`, 0.9793215736878705}, {
           2.984533322188339, 0.040215283336699104`}}, 0.03059636970355739]}, 
         InsetBox["1", {3.0126114372386175`, 0.5097684285122848}, ImageScaled[
          {0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{3.0406895522888964`, 0.9793215736878705}, {
           3.0496005168760956`, 2.0450018357846353`}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {3.0451450345824957`, 1.512161704736253}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.0706726951048497`, 0.9710076615678785}, {
           2.079163387865654, 2.0692690369982634`}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {2.074918041485252, 1.520138349283071}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.0706726951048497`, 0.9710076615678785}, {
           0.9709737408101397, 0.979415042429165}}, 0.03059636970355739]}, 
         InsetBox["1", {1.5208232179574948`, 0.9752113519985217}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.0706726951048497`, 0.9710076615678785}, {
           2.0448073993599243`, 0.}}, 0.03059636970355739]}, InsetBox[
          RowBox[{"-", "1"}], {2.057740047232387, 0.48550383078393927`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.071268465228156, 3.040025127205114}, {
           1.0052126492944011`, 3.0499094879662656`}}, 0.03059636970355739]}, 
         InsetBox["1", {1.5382405572612785`, 3.04496730758569}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.071268465228156, 3.040025127205114}, {
           2.079163387865654, 2.0692690369982634`}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {2.075215926546905, 2.5546470821016887`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.071268465228156, 3.040025127205114}, {
           3.010767543719247, 2.9853758865773647`}}, 0.03059636970355739]}, 
         InsetBox["1", {2.5410180044737016`, 3.0127005068912394`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0052126492944011`, 3.0499094879662656`}, {
           0.9809310316206455, 2.0786900924831326`}}, 0.03059636970355739]}, 
         InsetBox["1", {0.9930718404575234, 2.564299790224699}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0052126492944011`, 3.0499094879662656`}, {
           0.06540264528686057, 3.010008639743823}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {0.5353076472906309, 3.029959063855044}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9809310316206455, 2.0786900924831326`}, {
           0.010051704402732176`, 2.070519340645611}}, 0.03059636970355739]}, 
         InsetBox["1", {0.49549136801168886`, 2.0746047165643717`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9809310316206455, 2.0786900924831326`}, {
           2.079163387865654, 2.0692690369982634`}}, 0.03059636970355739]}, 
         InsetBox["1", {1.53004720974315, 2.0739795647406982`}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9809310316206455, 2.0786900924831326`}, {
           0.9709737408101397, 0.979415042429165}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {0.9759523862153926, 1.5290525674561488`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.010051704402732176`, 2.070519340645611}, {
           0.06540264528686057, 3.010008639743823}}, 0.03059636970355739]}, 
         InsetBox["1", {0.037727174844796374`, 2.540263990194717}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.010051704402732176`, 2.070519340645611}, {0., 
           1.004545853427392}}, 0.03059636970355739]}, 
         InsetBox["1", {0.005025852201366088, 1.5375325970365015`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.984533322188339, 0.040215283336699104`}, {
           2.0448073993599243`, 0.}}, 0.03059636970355739]}, InsetBox[
          RowBox[{"-", "1"}], {2.5146703607741316`, 0.020107641668349552`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.079163387865654, 2.0692690369982634`}, {
           3.0496005168760956`, 2.0450018357846353`}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {2.5643819523708746`, 2.0571354363914494`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9709737408101397, 0.979415042429165}, {0., 
           1.004545853427392}}, 0.03059636970355739]}, InsetBox[
          RowBox[{"-", "1"}], {0.4854868704050698, 0.9919804479282786}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9709737408101397, 0.979415042429165}, {
           0.9781703031813834, 0.009045153685254492}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {0.9745720219957615, 0.49423009805720974`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{3.010767543719247, 2.9853758865773647`}, {
           3.0496005168760956`, 2.0450018357846353`}}, 0.03059636970355739]}, 
         InsetBox[
          RowBox[{"-", "1"}], {3.0301840302976712`, 2.515188861181}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0., 1.004545853427392}, {0.03882710188412686, 
           0.06461919594814969}}, 0.03059636970355739]}, InsetBox[
          RowBox[{"-", "1"}], {0.01941355094206343, 0.5345825246877709}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9781703031813834, 0.009045153685254492}, {
           0.03882710188412686, 0.06461919594814969}}, 0.03059636970355739]}, 
         InsetBox["1", {0.5084987025327552, 0.03683217481670209}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9781703031813834, 0.009045153685254492}, {
           2.0448073993599243`, 0.}}, 0.03059636970355739]}, 
         InsetBox["1", {1.511488851270654, 0.004522576842627246}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{3.0406895522888964`, 0.9793215736878705}, 
          0.03059636970355739], 
         InsetBox["3", 
          Offset[{2, 2}, {3.0712859219924535`, 1.0099179433914278`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.0706726951048497`, 0.9710076615678785}, 
          0.03059636970355739], 
         InsetBox["7", Offset[{2, 2}, {2.101269064808407, 1.001604031271436}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.071268465228156, 3.040025127205114}, 0.03059636970355739],
          InsetBox["5", 
          Offset[{2, 2}, {2.101864834931713, 3.0706214969086716`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.0052126492944011`, 3.0499094879662656`}, 
          0.03059636970355739], 
         InsetBox["9", 
          Offset[{2, 2}, {1.0358090189979585`, 3.0805058576698228`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9809310316206455, 2.0786900924831326`}, 
          0.03059636970355739], 
         InsetBox["10", 
          Offset[{2, 2}, {1.0115274013242028`, 2.10928646218669}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.010051704402732176`, 2.070519340645611}, 
          0.03059636970355739], 
         InsetBox["14", 
          Offset[{2, 2}, {0.04064807410628957, 2.101115710349168}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.984533322188339, 0.040215283336699104`}, 
          0.03059636970355739], 
         InsetBox["4", 
          Offset[{2, 2}, {3.0151296918918966`, 0.0708116530402565}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.06540264528686057, 3.010008639743823}, 
          0.03059636970355739], 
         InsetBox["13", 
          Offset[{2, 2}, {0.09599901499041796, 3.04060500944738}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.079163387865654, 2.0692690369982634`}, 
          0.03059636970355739], 
         InsetBox["6", 
          Offset[{2, 2}, {2.1097597575692113`, 2.099865406701821}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9709737408101397, 0.979415042429165}, 
          0.03059636970355739], 
         InsetBox["11", 
          Offset[{2, 2}, {1.001570110513697, 1.0100114121327224`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.010767543719247, 2.9853758865773647`}, 
          0.03059636970355739], 
         InsetBox["1", 
          Offset[{2, 2}, {3.0413639134228045`, 3.0159722562809224`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 1.004545853427392}, 0.03059636970355739], 
         InsetBox["15", 
          Offset[{2, 2}, {0.03059636970355739, 1.0351422231309495`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9781703031813834, 0.009045153685254492}, 
          0.03059636970355739], 
         InsetBox["12", 
          Offset[{2, 2}, {1.0087666728849407`, 0.03964152338881188}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.03882710188412686, 0.06461919594814969}, 
          0.03059636970355739], 
         InsetBox["16", 
          Offset[{2, 2}, {0.06942347158768425, 0.09521556565170708}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.0448073993599243`, 0.}, 0.03059636970355739], 
         InsetBox["8", 
          Offset[{2, 2}, {2.075403769063482, 0.03059636970355739}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.0496005168760956`, 2.0450018357846353`}, 
          0.03059636970355739], 
         InsetBox["2", Offset[{2, 2}, {3.080196886579653, 2.075598205488193}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]]]], "Output",
 CellChangeTimes->{{3.678361434756804*^9, 3.678361436635132*^9}, 
   3.678362486029046*^9, 3.678362519495273*^9, 3.678369799659173*^9, 
   3.678370821278919*^9, {3.678371036170706*^9, 3.67837104203265*^9}, 
   3.6783711480185757`*^9, {3.678371195476366*^9, 3.6783712143979807`*^9}, 
   3.678371511292664*^9, {3.678371707429302*^9, 3.678371711486676*^9}, 
   3.678372492005575*^9, {3.678372539111623*^9, 3.6783725991763897`*^9}, 
   3.678372641826632*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"nextVertex", "[", 
      RowBox[{"#", ",", "1", ",", "L"}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"VertexList", "[", "lattice", "]"}]}]], "Input",
 CellChangeTimes->{{3.678371000124469*^9, 3.678371030381425*^9}, 
   3.678371146851035*^9, {3.678371193394272*^9, 3.678371212721517*^9}, {
   3.678371291139064*^9, 3.678371329869693*^9}, {3.678372544661723*^9, 
   3.678372546051852*^9}, 3.6783729954448433`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6783710148352137`*^9, 3.678371042077793*^9}, 
   3.678371148070343*^9, {3.678371195539753*^9, 3.678371214430344*^9}, {
   3.6783713133379517`*^9, 3.678371330277556*^9}, 3.6783715113414173`*^9, {
   3.678371707475479*^9, 3.678371711539002*^9}, 3.678372492066914*^9, {
   3.678372539149708*^9, 3.6783725992495747`*^9}, 3.678372641885244*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"previousVertex", "[", 
      RowBox[{"#", ",", "1", ",", "L"}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"VertexList", "[", "lattice", "]"}]}]], "Input",
 CellChangeTimes->{{3.6783712589044237`*^9, 3.678371277991639*^9}, {
   3.6783713431611032`*^9, 3.678371356709537*^9}, {3.678372548277398*^9, 
   3.678372552109942*^9}, 3.67837297327569*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67837127885284*^9, 3.6783715113935013`*^9, {3.6783717075218287`*^9, 
   3.67837171158333*^9}, 3.678372492118988*^9, {3.678372539205043*^9, 
   3.678372599306129*^9}, 3.6783726419385777`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"nextVertex", "[", 
      RowBox[{"#", ",", "2", ",", "L"}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"VertexList", "[", "lattice", "]"}]}]], "Input",
 CellChangeTimes->{{3.678371000124469*^9, 3.678371030381425*^9}, 
   3.678371146851035*^9, {3.678371193394272*^9, 3.678371212721517*^9}, {
   3.678371291139064*^9, 3.678371329869693*^9}, 3.67837170359932*^9, {
   3.678372554806755*^9, 3.678372556611808*^9}, 3.678372971066792*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6783710148352137`*^9, 3.678371042077793*^9}, 
   3.678371148070343*^9, {3.678371195539753*^9, 3.678371214430344*^9}, {
   3.6783713133379517`*^9, 3.678371330277556*^9}, 3.6783715113414173`*^9, {
   3.678371707571045*^9, 3.67837171164305*^9}, 3.678372492185096*^9, {
   3.678372539252535*^9, 3.678372599363871*^9}, 3.678372641988636*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"previousVertex", "[", 
      RowBox[{"#", ",", "2", ",", "L"}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"VertexList", "[", "lattice", "]"}]}]], "Input",
 CellChangeTimes->{{3.6783712589044237`*^9, 3.678371277991639*^9}, {
   3.6783713431611032`*^9, 3.678371356709537*^9}, 3.6783717056057587`*^9, {
   3.678372559582622*^9, 3.6783725614685287`*^9}, 3.678372968035931*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "False"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67837127885284*^9, 3.6783715113935013`*^9, {3.6783717076211157`*^9, 
   3.678371711689683*^9}, 3.678372492250682*^9, {3.678372539305501*^9, 
   3.678372599429996*^9}, 3.678372642043097*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.678372938094735*^9, 3.678372964636842*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Function", " ", "to", " ", "map", " ", "Plaquettes", " ", "as", " ", 
    "lists", " ", "of", " ", "edges", " ", "\[IndentingNewLine]", 
    RowBox[{"LabelPlaquettes", "[", 
     RowBox[{"L_", ",", "d_"}], "]"}]}], ":="}], "*)"}]], "Input",
 CellChangeTimes->{{3.6783614960327463`*^9, 3.678361505092247*^9}, {
   3.6783616835768213`*^9, 3.6783616915450068`*^9}, {3.678361823606471*^9, 
   3.6783618787827253`*^9}, {3.678361922030375*^9, 3.678361955842935*^9}, 
   3.678362391812249*^9, {3.678362876490384*^9, 3.678362883016759*^9}, {
   3.678372587145648*^9, 3.678372592072927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Subsets", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.678363275829728*^9, 3.678363297257942*^9}, 
   3.6783633316075087`*^9, {3.678363373934218*^9, 3.678363392381269*^9}, {
   3.678363707152337*^9, 3.67836374873545*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.67836328490035*^9, 3.678363297887603*^9}, 
   3.678363331984065*^9, 3.6783633745240583`*^9, {3.678363712935413*^9, 
   3.67836374900699*^9}, 3.678369799769011*^9, 3.678370821430977*^9, {
   3.678371036333374*^9, 3.678371042167719*^9}, 3.678371148166408*^9, {
   3.678371195652658*^9, 3.678371214522274*^9}, 3.678371511503291*^9, {
   3.678371707717641*^9, 3.6783717117911673`*^9}, 3.6783724923773413`*^9, {
   3.678372539416642*^9, 3.678372599489214*^9}, 3.6783726421001663`*^9}]
}, Open  ]]
},
WindowSize->{1044, 1131},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 145, 3, 28, "Input"],
Cell[706, 25, 352, 8, 28, "Input"],
Cell[1061, 35, 203, 5, 46, "Input"],
Cell[1267, 42, 820, 14, 28, "Input"],
Cell[CellGroupData[{
Cell[2112, 60, 1398, 36, 97, "Input"],
Cell[3513, 98, 13977, 283, 382, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17527, 386, 499, 11, 28, "Input"],
Cell[18029, 399, 1388, 39, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19454, 443, 432, 10, 28, "Input"],
Cell[19889, 455, 1240, 38, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21166, 498, 518, 11, 28, "Input"],
Cell[21687, 511, 1386, 39, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23110, 555, 459, 10, 28, "Input"],
Cell[23572, 567, 1237, 38, 46, "Output"]
}, Open  ]],
Cell[24824, 608, 92, 1, 28, "Input"],
Cell[24919, 611, 639, 12, 46, "Input"],
Cell[CellGroupData[{
Cell[25583, 627, 354, 8, 28, "Input"],
Cell[25940, 637, 732, 15, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15523,        354]
NotebookOptionsPosition[     14791,        324]
NotebookOutlinePosition[     15145,        340]
CellTagsIndexPosition[     15102,        337]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";", 
  RowBox[{"Clear", "[", "Derivative", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<lattice.wl\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.678288586928876*^9, 3.678288652689226*^9}, {
   3.678292473759671*^9, 3.678292578091207*^9}, {3.678350870848344*^9, 
   3.678350873880072*^9}, 3.678350912079718*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lattice", "=", 
   RowBox[{"getLattice", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6783488702420597`*^9, 3.678348879544608*^9}, {
   3.678349118892337*^9, 3.678349126539381*^9}, 3.6783498892441196`*^9, 
   3.6783503661619253`*^9, 3.678350885607624*^9, 3.678351035676862*^9, 
   3.678352665347506*^9, {3.678353138761796*^9, 3.6783531569207973`*^9}, 
   3.6783532613210087`*^9, 3.678353295382255*^9, {3.678353327125453*^9, 
   3.6783533393493032`*^9}, {3.678353770204639*^9, 3.678353770572095*^9}, {
   3.6783602618691797`*^9, 3.678360269879266*^9}, {3.6783603522374268`*^9, 
   3.678360378020096*^9}, {3.678360511322579*^9, 3.678360511425651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VertexList", "[", "lattice", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.678348882931779*^9, 3.67834888722585*^9}, {
   3.678349223755831*^9, 3.6783492246976433`*^9}, {3.6783503698103027`*^9, 
   3.6783503698980083`*^9}, 3.6783531726325417`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input"],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{
  3.678349921196928*^9, 3.6783500331999283`*^9, {3.678350204431199*^9, 
   3.678350213619213*^9}, {3.6783502469173613`*^9, 3.6783502498723783`*^9}, 
   3.6783503481887903`*^9, {3.67835039121334*^9, 3.6783504080937757`*^9}, 
   3.678350790210629*^9, {3.6783508565620413`*^9, 3.6783509148415737`*^9}, {
   3.6783510150522203`*^9, 3.678351037021839*^9}, {3.678351140734313*^9, 
   3.678351149222221*^9}, 3.678351189426111*^9, {3.678352152860264*^9, 
   3.678352162375907*^9}, {3.678352258586627*^9, 3.678352264070956*^9}, 
   3.678352295731147*^9, 3.67835236732856*^9, {3.678352485689678*^9, 
   3.678352492767432*^9}, {3.678352627015046*^9, 3.6783526803842363`*^9}, {
   3.678352739086259*^9, 3.678352768219284*^9}, {3.678353008916121*^9, 
   3.678353024843305*^9}, {3.678353114950324*^9, 3.678353196846822*^9}, {
   3.678353262528878*^9, 3.678353297814221*^9}, {3.678353328880095*^9, 
   3.678353343968745*^9}, {3.678353729256795*^9, 3.6783537964422817`*^9}, {
   3.67836026363269*^9, 3.678360271366982*^9}, {3.6783603534611998`*^9, 
   3.6783603970714006`*^9}, 3.678360512776229*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdgeList", "[", "lattice", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.678349283027191*^9, 3.6783492862478743`*^9}, {
   3.678350372090365*^9, 3.6783503721621447`*^9}, 3.678353172002659*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.67834929254748*^9, 3.6783492958657312`*^9}}],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{{3.67834929627179*^9, 3.67834929760655*^9}, 
   3.678349372440608*^9, 3.6783498299238787`*^9, {3.67834986599767*^9, 
   3.678349921297379*^9}, 3.6783500332987137`*^9, {3.6783502045094023`*^9, 
   3.678350213720578*^9}, {3.678350247019245*^9, 3.6783502502908287`*^9}, 
   3.678350348272643*^9, {3.678350391297175*^9, 3.6783504081777143`*^9}, 
   3.6783507903165827`*^9, {3.678350856633004*^9, 3.678350914935115*^9}, {
   3.678351015152062*^9, 3.6783510371215687`*^9}, {3.6783511408014297`*^9, 
   3.678351149298296*^9}, 3.678351189499159*^9, {3.6783521529316673`*^9, 
   3.678352162458147*^9}, {3.6783522586703978`*^9, 3.6783522644381323`*^9}, 
   3.6783522958145027`*^9, 3.67835236747902*^9, {3.678352485848564*^9, 
   3.678352492934999*^9}, {3.678352627188724*^9, 3.678352680548254*^9}, {
   3.678352739221512*^9, 3.6783527683516903`*^9}, {3.678353008989661*^9, 
   3.678353024914646*^9}, {3.678353115119974*^9, 3.678353196926008*^9}, {
   3.678353262608418*^9, 3.678353297895481*^9}, {3.678353328967671*^9, 
   3.678353344050672*^9}, {3.678353729344091*^9, 3.678353796525661*^9}, {
   3.678360263693309*^9, 3.678360271416951*^9}, {3.6783603535402613`*^9, 
   3.6783603971218653`*^9}, 3.6783605128169947`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lattice", "=", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SetProperty", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
      "lattice", ",", 
      RowBox[{"VertexList", "[", "lattice", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"lattice", "=", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetProperty", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#1", ",", "#2"}], "}"}], ",", 
       RowBox[{"EdgeLabels", "\[Rule]", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}], ",", "EdgeCapacity"}], "]"}]}]}],
       "]"}], "&"}], ",", "lattice", ",", 
    RowBox[{"EdgeList", "[", "lattice", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.678348908971418*^9, 3.678348931371005*^9}, {
   3.678349148637714*^9, 3.678349206634297*^9}, 3.678349243986505*^9, {
   3.678350376763186*^9, 3.6783503889943323`*^9}, {3.678353022036406*^9, 
   3.6783530234119997`*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{4, 5, 6, 2, 3, 8, 9, 1, 7}, {
      Null, {{1, 2}, {2, 3}, {4, 5}, {6, 7}, {8, 4}, {8, 1}, {3, 7}, {9, 6}, {
       1, 9}, {2, 6}, {5, 3}, {4, 2}}}, {
      EdgeLabels -> {
        UndirectedEdge[3, 6] -> -1, UndirectedEdge[5, 6] -> 1, 
         UndirectedEdge[2, 3] -> 1, UndirectedEdge[5, 8] -> -1, 
         UndirectedEdge[4, 5] -> 1, UndirectedEdge[1, 4] -> 1, 
         UndirectedEdge[8, 9] -> 1, UndirectedEdge[4, 7] -> -1, 
         UndirectedEdge[2, 5] -> -1, UndirectedEdge[1, 2] -> 1, 
         UndirectedEdge[7, 8] -> -1, UndirectedEdge[6, 9] -> -1}, 
       VertexLabels -> {
        9 -> 9, 5 -> 5, 6 -> 6, 4 -> 4, 1 -> 1, 7 -> 7, 8 -> 8, 2 -> 2, 3 -> 
         3}, EdgeCapacity -> {1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
         {Arrowheads[0.], 
          ArrowBox[{{0.9920399037115454, 2.040921033494624}, {
           1.0208319002794979`, 1.0206907833436563`}}, 
           0.022951402108503466`]}, 
         InsetBox["1", {1.0064359019955216`, 1.53080590841914}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9920399037115454, 2.040921033494624}, {
           1.9812841919783053`, 2.0371524656967197`}}, 
           0.022951402108503466`]}, 
         InsetBox["1", {1.4866620478449253`, 2.039036749595672}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.9920399037115454, 2.040921033494624}, {
           0.003928832156581574, 1.9818714851916401`}}, 
           0.022951402108503466`]}, InsetBox[
          RowBox[{"-", "1"}], {0.4979843679340635, 2.0113962593431323`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0208319002794979`, 1.0206907833436563`}, {
           1.0492895754238352`, 0.}}, 0.022951402108503466`]}, 
         InsetBox["1", {1.0350607378516665`, 0.5103453916718281}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0208319002794979`, 1.0206907833436563`}, {
           2.042007650553236, 1.050028556267105}}, 0.022951402108503466`]}, 
         InsetBox[
          RowBox[{"-", "1"}], {1.531419775416367, 1.0353596698053806`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0208319002794979`, 1.0206907833436563`}, {0., 
           0.9929402629056961}}, 0.022951402108503466`]}, InsetBox[
          RowBox[{"-", "1"}], {0.5104159501397489, 1.0068155231246763`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0492895754238352`, 0.}, {2.0366792405589136`, 
           0.060905590540239696`}}, 0.022951402108503466`]}, InsetBox[
          RowBox[{"-", "1"}], {1.5429844079913744`, 0.030452795270119848`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.0492895754238352`, 0.}, {0.05974998522084263, 
           0.005644911004874187}}, 0.022951402108503466`]}, InsetBox[
          RowBox[{"-", "1"}], {0.554519780322339, 0.0028224555024370934`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.042007650553236, 1.050028556267105}, {
           2.0366792405589136`, 0.060905590540239696`}}, 
           0.022951402108503466`]}, 
         InsetBox["1", {2.039343445556075, 0.5554670734036724}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{2.042007650553236, 1.050028556267105}, {
           1.9812841919783053`, 2.0371524656967197`}}, 
           0.022951402108503466`]}, 
         InsetBox["1", {2.011645921265771, 1.5435905109819124`}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0., 0.9929402629056961}, {0.05974998522084263, 
           0.005644911004874187}}, 0.022951402108503466`]}, 
         InsetBox["1", {0.029874992610421314`, 0.49929258695528517`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0., 0.9929402629056961}, {0.003928832156581574, 
           1.9818714851916401`}}, 0.022951402108503466`]}, InsetBox[
          RowBox[{"-", "1"}], {0.001964416078290787, 1.4874058740486682`}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{0.9920399037115454, 2.040921033494624}, 
          0.022951402108503466`], 
         InsetBox["4", 
          Offset[{2, 2}, {1.0149913058200488`, 2.0638724356031273`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.0208319002794979`, 1.0206907833436563`}, 
          0.022951402108503466`], 
         InsetBox["5", 
          Offset[{2, 2}, {1.0437833023880014`, 1.0436421854521598`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.0492895754238352`, 0.}, 0.022951402108503466`], 
         InsetBox["6", 
          Offset[{2, 2}, {1.0722409775323387`, 0.022951402108503466`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.042007650553236, 1.050028556267105}, 
          0.022951402108503466`], 
         InsetBox["2", 
          Offset[{2, 2}, {2.0649590526617394`, 1.0729799583756086`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.0366792405589136`, 0.060905590540239696`}, 
          0.022951402108503466`], 
         InsetBox["3", 
          Offset[{2, 2}, {2.059630642667417, 0.08385699264874316}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 0.9929402629056961}, 0.022951402108503466`], 
         InsetBox["8", 
          Offset[{2, 2}, {0.022951402108503466`, 1.0158916650141996`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.05974998522084263, 0.005644911004874187}, 
          0.022951402108503466`], 
         InsetBox["9", 
          Offset[{2, 2}, {0.0827013873293461, 0.028596313113377653`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.9812841919783053`, 2.0371524656967197`}, 
          0.022951402108503466`], 
         InsetBox["1", 
          Offset[{2, 2}, {2.0042355940868086`, 2.060103867805223}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.003928832156581574, 1.9818714851916401`}, 
          0.022951402108503466`], 
         InsetBox["7", 
          Offset[{2, 2}, {0.02688023426508504, 2.0048228873001435`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{622.20703125, Automatic}]], "Output",
 CellChangeTimes->{
  3.6783492456860237`*^9, 3.67834929765351*^9, 3.678349372514503*^9, 
   3.6783498299895077`*^9, {3.678349866066334*^9, 3.678349921370214*^9}, 
   3.678350033376734*^9, {3.678350204597047*^9, 3.678350213796152*^9}, {
   3.6783502471140423`*^9, 3.678350250365343*^9}, 3.678350348323306*^9, {
   3.678350391355777*^9, 3.678350408225092*^9}, 3.67835079037642*^9, {
   3.6783508566877737`*^9, 3.6783509149776373`*^9}, {3.678351015213387*^9, 
   3.678351037191367*^9}, {3.678351140859334*^9, 3.678351149681932*^9}, 
   3.678351189558299*^9, {3.678352152989551*^9, 3.678352162513793*^9}, {
   3.678352258737115*^9, 3.678352264497123*^9}, 3.6783522959024267`*^9, 
   3.678352367711883*^9, {3.678352486038102*^9, 3.6783524931213493`*^9}, {
   3.6783526273840322`*^9, 3.678352680735217*^9}, {3.67835273936557*^9, 
   3.678352768500733*^9}, {3.678353009048451*^9, 3.678353024984684*^9}, {
   3.67835311547787*^9, 3.678353197709855*^9}, {3.6783532627819777`*^9, 
   3.6783532982360983`*^9}, {3.67835332913404*^9, 3.6783533442502193`*^9}, {
   3.6783537294799*^9, 3.678353796811173*^9}, {3.6783602638482533`*^9, 
   3.678360271612837*^9}, {3.678360354985301*^9, 3.6783603971894093`*^9}, 
   3.678360512881672*^9}]
}, Open  ]]
},
WindowSize->{1044, 1131},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 145, 3, 28, "Input"],
Cell[706, 25, 352, 8, 28, "Input"],
Cell[1061, 35, 722, 12, 28, "Input"],
Cell[1786, 49, 282, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[2093, 58, 59, 1, 28, "Input"],
Cell[2155, 61, 1132, 16, 28, "Output"]
}, Open  ]],
Cell[3302, 80, 227, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[3554, 88, 126, 2, 28, "Input"],
Cell[3683, 92, 1259, 17, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4979, 114, 1193, 33, 63, "Input"],
Cell[6175, 149, 8600, 172, 673, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     20931,        473]
NotebookOptionsPosition[     20010,        441]
NotebookOutlinePosition[     20361,        457]
CellTagsIndexPosition[     20318,        454]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"L", " ", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ns", "=", 
   RowBox[{"L", "^", "d"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Delta", "=", "1.99"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"r", "=", 
    RowBox[{"1", "-", 
     RowBox[{"(", 
      RowBox[{"J2", "/", "J1"}], ")"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "0.65"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"J1", "=", " ", 
  RowBox[{"2", 
   RowBox[{"J", " ", "/", 
    RowBox[{"(", 
     RowBox[{"2", "-", "r"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"J2", "=", 
  RowBox[{"2", "J", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "r"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "-", "r"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.667038528539003*^9, 3.667038546636681*^9}, {
   3.667038619053512*^9, 3.6670386215538*^9}, {3.66705117792957*^9, 
   3.6670511883595057`*^9}, {3.667051536614438*^9, 3.66705158213514*^9}, {
   3.66705161785721*^9, 3.667051619701832*^9}, {3.667051654208261*^9, 
   3.6670516850867662`*^9}, 3.667051767113257*^9, {3.6760088835548477`*^9, 
   3.6760088848695908`*^9}, {3.676011366797484*^9, 3.6760113714310703`*^9}, 
   3.676012322741296*^9, {3.676098029739072*^9, 3.676098029914591*^9}, {
   3.67618991413243*^9, 3.6761899158492727`*^9}, {3.6761900983915453`*^9, 
   3.6761901023731213`*^9}, {3.676190508781294*^9, 3.676190542466305*^9}, {
   3.6761906306163797`*^9, 3.676190724581889*^9}, {3.676192089342702*^9, 
   3.67619210382976*^9}, {3.676207223173102*^9, 3.6762072493944607`*^9}, {
   3.676207303732058*^9, 3.676207379056759*^9}, {3.676207420583384*^9, 
   3.676207447621971*^9}, 3.6762369954069843`*^9, {3.6762703101184807`*^9, 
   3.676270320228889*^9}, 3.6762716210100603`*^9, 3.676271669090567*^9, 
   3.676289570582324*^9, 3.676289626781155*^9, 3.6762920846891403`*^9, {
   3.676297066130662*^9, 3.6762971380163937`*^9}, {3.676297193833205*^9, 
   3.676297302067997*^9}, {3.67629734683814*^9, 3.676297428652214*^9}, 
   3.676297461843423*^9, {3.6762993525810127`*^9, 3.676299365397504*^9}, {
   3.676306514613409*^9, 3.676306520891883*^9}, 3.676306573674697*^9, 
   3.6763066216260777`*^9, {3.6763079137031307`*^9, 3.676307914708651*^9}, {
   3.67630828150416*^9, 3.676308326766419*^9}, {3.676308609319916*^9, 
   3.676308658020466*^9}, 3.6763086987004223`*^9, {3.676308744676106*^9, 
   3.676308787023589*^9}, {3.676308984708858*^9, 3.6763090196988907`*^9}, {
   3.676319218716613*^9, 3.6763192393305607`*^9}, 3.676319286129506*^9, {
   3.676319324711946*^9, 3.676319334264338*^9}, 3.676319369359289*^9, 
   3.676319435959167*^9, {3.6763195284351473`*^9, 3.6763195560901537`*^9}, {
   3.6763198143700447`*^9, 3.6763198366015167`*^9}, 3.676319877392956*^9, {
   3.676361817600252*^9, 3.676361847606888*^9}, {3.676361933936761*^9, 
   3.6763619610673122`*^9}, {3.676362135893235*^9, 3.6763621480309067`*^9}, {
   3.6763627620432587`*^9, 3.67636283679253*^9}, 3.676362931119561*^9, {
   3.6763629877968063`*^9, 3.676363000027697*^9}, 3.676363051194209*^9, {
   3.6763631037013817`*^9, 3.676363187973768*^9}, {3.6763632451183023`*^9, 
   3.676363318857074*^9}, {3.676363464167801*^9, 3.6763634885246143`*^9}, {
   3.676370763345008*^9, 3.676370801854735*^9}, {3.676371977576707*^9, 
   3.6763719875028057`*^9}, 3.676372188210443*^9, {3.676372317985189*^9, 
   3.676372319942721*^9}, 3.676373155492214*^9, {3.676374279804633*^9, 
   3.67637428310044*^9}, 3.6763743283957243`*^9, {3.6763747875022097`*^9, 
   3.6763748340446577`*^9}, 3.676375015182329*^9, {3.676375262872375*^9, 
   3.6763752654396257`*^9}, 3.676377452308568*^9, 3.6764752672473392`*^9, {
   3.676488471452104*^9, 3.676488471510975*^9}, 3.676488585027923*^9, 
   3.676488759686121*^9, {3.676488799467905*^9, 3.676488799603417*^9}, 
   3.676488989166341*^9, {3.6764896570749187`*^9, 3.67648965721141*^9}, {
   3.676490068328067*^9, 3.676490068536174*^9}, 3.676490120083832*^9, {
   3.676542924749526*^9, 3.6765429268049297`*^9}, {3.676543030075344*^9, 
   3.676543045094541*^9}, {3.676614409082664*^9, 3.676614436519178*^9}, {
   3.676616713497323*^9, 3.676616714175157*^9}, {3.6766169040665913`*^9, 
   3.676616924851202*^9}, 3.6766170076268473`*^9, {3.6766284771285477`*^9, 
   3.676628477200122*^9}, {3.676628519992944*^9, 3.6766285308873672`*^9}, 
   3.676628585837627*^9, {3.676628635693077*^9, 3.676628635747751*^9}, {
   3.6766288875912657`*^9, 3.676628889630445*^9}, 3.676629192640465*^9, {
   3.676629422522992*^9, 3.676629422595007*^9}, {3.676629537887491*^9, 
   3.6766295672545023`*^9}, {3.6766296823253527`*^9, 3.67662968598004*^9}, 
   3.676629910280756*^9, 3.676629941616049*^9, 3.676630046351295*^9, {
   3.67663007751641*^9, 3.676630098900424*^9}, {3.676630129139525*^9, 
   3.676630157170929*^9}, 3.676630262840788*^9, {3.67663030139198*^9, 
   3.6766303033436747`*^9}, 3.676630368031642*^9, 3.67663119158143*^9, 
   3.676631232933221*^9, {3.676631899438143*^9, 3.676631924026173*^9}, {
   3.6766335633291197`*^9, 3.676633588704199*^9}, {3.676634902171627*^9, 
   3.676634914249494*^9}, {3.67663745465865*^9, 3.67663745644878*^9}, {
   3.676637501888183*^9, 3.6766375458784723`*^9}, 3.676637648355484*^9, 
   3.676640194117384*^9, 3.676640238972975*^9, {3.676640488405953*^9, 
   3.676640488501334*^9}, 3.676640623818851*^9, {3.676640817846875*^9, 
   3.676640817997712*^9}, 3.676640983563253*^9, {3.676641275340888*^9, 
   3.676641278971302*^9}, 3.6766416195014257`*^9, {3.676657342029872*^9, 
   3.67665735909949*^9}, 3.676659042669924*^9, 3.676659089374157*^9, {
   3.676659123259118*^9, 3.6766591362894382`*^9}, {3.6766591754248466`*^9, 
   3.676659228406567*^9}, {3.6766592742384577`*^9, 3.6766593282437553`*^9}, 
   3.6766593767612133`*^9, 3.6766594997118073`*^9, 3.676696999882283*^9, {
   3.676729466845683*^9, 3.676729471562751*^9}, 3.676729594001541*^9, 
   3.676729628988337*^9, 3.6767348562378693`*^9, {3.676735763761282*^9, 
   3.676735769237296*^9}, 3.676737267227181*^9, 3.676737433693078*^9, {
   3.676737479885494*^9, 3.676737481884605*^9}, {3.676738150406996*^9, 
   3.676738175549116*^9}, {3.67673837616133*^9, 3.676738377735669*^9}, {
   3.676738427590048*^9, 3.676738456382193*^9}, {3.676738507172859*^9, 
   3.676738555364081*^9}, 3.676738587244972*^9, {3.6767387987585077`*^9, 
   3.676738802029887*^9}, 3.67673883965378*^9, {3.676738874788971*^9, 
   3.676738896036603*^9}, 3.676788387848617*^9, {3.676788501261694*^9, 
   3.676788519070941*^9}, {3.676789243645949*^9, 3.676789254644539*^9}, 
   3.676790858065075*^9, 3.676791446332013*^9, {3.676792056105357*^9, 
   3.676792077494183*^9}, 3.6767921782519712`*^9, {3.676792229701322*^9, 
   3.6767922395468493`*^9}, 3.676792328233939*^9, {3.676792387474625*^9, 
   3.676792452343915*^9}, {3.676792484774514*^9, 3.6767924849901123`*^9}, {
   3.676792616699499*^9, 3.6767926225543327`*^9}, 3.6767926736586103`*^9, {
   3.6767927562475*^9, 3.676792780352384*^9}, 3.676792841558607*^9, {
   3.676792909549382*^9, 3.676792991083562*^9}, {3.676793051858457*^9, 
   3.6767930541766777`*^9}, 3.6768074615565453`*^9, 3.676807644849112*^9, 
   3.676807891489043*^9, {3.6768079834564667`*^9, 3.676807983550364*^9}, {
   3.6768080420776863`*^9, 3.6768081030211287`*^9}, 3.676808147068712*^9, {
   3.676808194347288*^9, 3.676808196490407*^9}, 3.676808508012281*^9, 
   3.6768085522833557`*^9, 3.676808722065096*^9, {3.6768088487905207`*^9, 
   3.676808912579949*^9}, {3.6768090524100246`*^9, 3.676809103622315*^9}, {
   3.6768091573673267`*^9, 3.676809157548848*^9}, {3.6768092156302357`*^9, 
   3.676809353962781*^9}, {3.676813463218813*^9, 3.676813493016184*^9}, {
   3.676813557121035*^9, 3.67681364835142*^9}, {3.67681368872641*^9, 
   3.6768136915876427`*^9}, {3.6768137280125923`*^9, 3.676813792204299*^9}, {
   3.676813864282977*^9, 3.676813865088214*^9}, {3.67681390229771*^9, 
   3.676813909921358*^9}, 3.676813978960458*^9, {3.6768140191270123`*^9, 
   3.676814107878108*^9}, {3.67681426409794*^9, 3.6768142770976477`*^9}, {
   3.676814534483467*^9, 3.676814564811676*^9}, {3.6768146018022823`*^9, 
   3.676814618530592*^9}, {3.676815660947475*^9, 3.676815679335309*^9}, 
   3.6768171925071287`*^9, {3.676827987874515*^9, 3.6768279879431543`*^9}, 
   3.676830639250587*^9, 3.676875022811593*^9, {3.6768770652262087`*^9, 
   3.676877065392815*^9}, 3.676878615755657*^9, {3.676879151599161*^9, 
   3.6768791535579576`*^9}, 3.676879186715805*^9, {3.676879218898747*^9, 
   3.676879227458846*^9}, {3.6768840049315643`*^9, 3.676884015249751*^9}, {
   3.67688482093713*^9, 3.676884900006337*^9}, {3.6768849438859787`*^9, 
   3.6768849439892807`*^9}, {3.676884988566283*^9, 3.676885094602408*^9}, {
   3.6768852068408318`*^9, 3.676885241496203*^9}, 3.676885337415596*^9, {
   3.676885425310279*^9, 3.676885425636022*^9}, 3.6768855350900793`*^9, 
   3.676885667687789*^9, 3.676885812227666*^9, {3.6768871037876062`*^9, 
   3.67688712239324*^9}, {3.676890555876891*^9, 3.676890568084614*^9}, 
   3.6768908295541077`*^9, 3.676890986246014*^9, 3.676891280625647*^9, 
   3.676891420850142*^9}],

Cell[BoxData["1.4814814814814814`"], "Output",
 CellChangeTimes->{
  3.676884490019453*^9, 3.676884554381043*^9, 3.676884595974094*^9, {
   3.676884665395556*^9, 3.676884691226644*^9}, {3.676884757114789*^9, 
   3.6768847799861298`*^9}, {3.676884825728903*^9, 3.676884914210761*^9}, {
   3.676884946458949*^9, 3.67688509593668*^9}, {3.676885231108631*^9, 
   3.676885242635764*^9}, 3.676885338938037*^9, 3.676885428683248*^9, 
   3.676885537037313*^9, 3.676885615486343*^9, {3.676885669258978*^9, 
   3.676885697737863*^9}, 3.676885818221496*^9, {3.676887117507567*^9, 
   3.676887125730047*^9}, 3.67689048971736*^9, 3.676890570204193*^9, 
   3.676890831308732*^9, 3.676890988984321*^9, 3.676891282705147*^9, 
   3.676891422429772*^9}],

Cell[BoxData["0.5185185185185185`"], "Output",
 CellChangeTimes->{
  3.676884490019453*^9, 3.676884554381043*^9, 3.676884595974094*^9, {
   3.676884665395556*^9, 3.676884691226644*^9}, {3.676884757114789*^9, 
   3.6768847799861298`*^9}, {3.676884825728903*^9, 3.676884914210761*^9}, {
   3.676884946458949*^9, 3.67688509593668*^9}, {3.676885231108631*^9, 
   3.676885242635764*^9}, 3.676885338938037*^9, 3.676885428683248*^9, 
   3.676885537037313*^9, 3.676885615486343*^9, {3.676885669258978*^9, 
   3.676885697737863*^9}, 3.676885818221496*^9, {3.676887117507567*^9, 
   3.676887125730047*^9}, 3.67689048971736*^9, 3.676890570204193*^9, 
   3.676890831308732*^9, 3.676890988984321*^9, 3.676891282705147*^9, 
   3.676891422440867*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nsamples", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.676817175288374*^9, 3.676817182888308*^9}, 
   3.676830644705103*^9, 3.676874762729857*^9, 3.676875020178925*^9, 
   3.6768786371359997`*^9, 3.676879823149448*^9, {3.676882034510161*^9, 
   3.676882036016439*^9}, 3.676884205014648*^9, {3.676884964477672*^9, 
   3.6768849819407053`*^9}, {3.676885228999139*^9, 3.676885229142655*^9}, 
   3.676885531123233*^9, 3.676885815730291*^9, 3.676887112870775*^9, 
   3.676890551619779*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid", " ", "=", " ", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"L", "-", "1"}]}], "]"}], ",", "d"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{3.676631403760498*^9, 3.6766376950079727`*^9, 
  3.676824825990288*^9, 3.6768289712203627`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"isBoundaryEdge", "[", 
    RowBox[{"i_", ",", "j_", ",", "L_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "^", "j"}], "-", 
     RowBox[{"L", "^", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}]}], "-", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"i", "-", "1"}], ",", 
       RowBox[{"L", "^", "j"}]}], "]"}]}], "\[LessEqual]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.676735884284772*^9, 3.67673601253926*^9}, 
   3.676824824294417*^9, 3.676828974348336*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeInternalEdges", "[", 
    RowBox[{"i_", ",", "d_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"isBoundaryEdge", "[", 
         RowBox[{"i", ",", "#2", ",", "L"}], "]"}], ",", "#1", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", 
             RowBox[{"L", "^", 
              RowBox[{"(", 
               RowBox[{"#2", "-", "1"}], ")"}]}]}]}], "}"}]}], "]"}]}], "]"}],
       "&"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "d"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676736103162651*^9, 3.676736365235435*^9}, {
   3.67673641991588*^9, 3.676736455794199*^9}, {3.6767365053550377`*^9, 
   3.6767365608149223`*^9}, 3.6768289780133057`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interalEdges", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"makeInternalEdges", "[", 
           RowBox[{"#2", ",", "d", ",", "L"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"L", "^", "d"}]}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67673608234779*^9, 3.676736084798193*^9}, {
   3.676736380556231*^9, 3.676736403283668*^9}, {3.676736467082353*^9, 
   3.676736467185959*^9}, {3.676737037445285*^9, 3.6767371153864803`*^9}, {
   3.6767373374084063`*^9, 3.676737341997635*^9}, 3.676737406751614*^9, 
   3.676737483555582*^9, {3.676791759424267*^9, 3.676791769324407*^9}, 
   3.676824823086493*^9, 3.67682897938125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBoundaryPeriodicEdges", "[", 
   RowBox[{"i_", ",", "d_", ",", "L_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"isBoundaryEdge", "[", 
        RowBox[{"i", ",", "#2", ",", "L"}], "]"}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"L", "^", "#2"}], "-", 
              RowBox[{"L", "^", 
               RowBox[{"(", 
                RowBox[{"#2", "-", "1"}], ")"}]}]}], ")"}]}], ",", "i"}], 
          "}"}]}], "]"}], ",", "#1"}], "]"}], "&"}], ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "d"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.676791968529189*^9, 3.676824821406598*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundaryEdges", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"makeBoundaryPeriodicEdges", "[", 
           RowBox[{"#2", ",", "d", ",", "L"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"L", "^", "d"}]}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67679078728819*^9, 3.6767908376487837`*^9}, {
   3.676791508362413*^9, 3.676791515417877*^9}, {3.676791774750354*^9, 
   3.6767917858921947`*^9}, 3.676824820702447*^9, 3.676828986084613*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ed", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"interalEdges", ",", "boundaryEdges"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676791805381118*^9, 3.6767918339229727`*^9}, 
   3.676792165476036*^9, 3.676824818758112*^9, 3.676828988820367*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgesToPoints", " ", "=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", "#", "]"}], "]"}], " ", "&"}], "/@", " ", "e"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6760273620393753`*^9, 3.67602742740661*^9}, 
   3.6760275406143093`*^9, 3.676824818038568*^9, 3.6768289959887133`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Jij", "[", 
    RowBox[{"g_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "e"}], "}"}], ",", "EdgeCapacity"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.6768248171100693`*^9, 3.6768290003243732`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cc", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"v", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gr", ",", "#"}], "}"}], ",", "EdgeCapacity"}], "]"}], 
       "&"}], "/@", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"gr", ",", 
        RowBox[{"v", "\[DirectedEdge]", "_"}]}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6762107737183943`*^9, 3.676210876476384*^9}, {
   3.6762111706008863`*^9, 3.676211209381258*^9}, {3.67621145439694*^9, 
   3.6762114845510387`*^9}, {3.6762116752774553`*^9, 3.676211723346428*^9}, {
   3.6762117781549597`*^9, 3.676211781681093*^9}, 3.676829006900879*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wi", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Jij", "[", 
         RowBox[{"gr", ",", " ", "#"}], "]"}], "&"}], "/@", " ", 
       RowBox[{"EdgeList", "[", 
        RowBox[{"gr", ",", 
         RowBox[{"v", "\[DirectedEdge]", "_"}]}], "]"}]}], "]"}]}], "+", 
    "Delta"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676199436135913*^9, 3.67619947935713*^9}, {
   3.676199791895864*^9, 3.676199838805048*^9}, {3.676199871918668*^9, 
   3.676199916819049*^9}, {3.676201162609152*^9, 3.67620118580623*^9}, {
   3.6762014337217197`*^9, 3.676201502064309*^9}, 3.6762015339591312`*^9, {
   3.6762019187675858`*^9, 3.676201977587693*^9}, {3.676202197055112*^9, 
   3.676202199382922*^9}, {3.6762022470464087`*^9, 3.676202248164878*^9}, 
   3.67620335115851*^9, 3.6762073074254208`*^9, {3.676207382865283*^9, 
   3.676207385879428*^9}, {3.676207475564427*^9, 3.67620748132533*^9}, 
   3.676207961338849*^9, 3.676208352980329*^9, {3.6762115487441874`*^9, 
   3.676211559950214*^9}, {3.676319669759914*^9, 3.67631968194141*^9}, 
   3.6763748912606897`*^9, 3.6763749572251*^9, 3.676824815934416*^9, 
   3.6768290108039713`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Spin", "[", "v_", "]"}], ":=", 
   RowBox[{"Last", "[", 
    RowBox[{"SpinConf", "[", 
     RowBox[{"[", "v", "]"}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Configurations", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676829149564516*^9, 3.6768291509193163`*^9}, {
   3.676879343704722*^9, 3.676879351895555*^9}, 3.676879878102681*^9, {
   3.676879920213976*^9, 3.676879955778216*^9}, 3.676880039040701*^9, {
   3.676890485694818*^9, 3.676890487357396*^9}}]
},
WindowSize->{808, 911},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 9323, 147, 182, "Input"],
Cell[9906, 171, 735, 11, 28, "Output"],
Cell[10644, 184, 735, 11, 28, "Output"]
}, Open  ]],
Cell[11394, 198, 526, 9, 28, "Input"],
Cell[11923, 209, 346, 10, 28, "Input"],
Cell[12272, 221, 557, 17, 28, "Input"],
Cell[12832, 240, 954, 26, 46, "Input"],
Cell[13789, 268, 930, 22, 46, "Input"],
Cell[14722, 292, 908, 26, 63, "Input"],
Cell[15633, 320, 741, 19, 46, "Input"],
Cell[16377, 341, 286, 6, 28, "Input"],
Cell[16666, 349, 425, 11, 28, "Input"],
Cell[17094, 362, 327, 10, 28, "Input"],
Cell[17424, 374, 764, 20, 28, "Input"],
Cell[18191, 396, 1252, 26, 28, "Input"],
Cell[19446, 424, 196, 6, 28, "Input"],
Cell[19645, 432, 361, 7, 28, "Input"]
}
]
*)

(* End of internal cache information *)

